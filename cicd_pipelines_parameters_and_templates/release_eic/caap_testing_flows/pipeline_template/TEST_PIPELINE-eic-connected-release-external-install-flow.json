{
  "appConfig": {},
  "application": "SPINNAKER_APPLICATION_NAME",
  "name": "SPINNAKER_PIPELINE_NAME",
  "description": "Template name: TEST_PIPELINE-eic-connected-release-external-install-flow.json in repo https://gerrit-gamma.gic.ericsson.se/#/admin/projects/OSS/com.ericsson.oss.cicd/oss-common-cicd-pipeline-resources,branches",
  "disabled": true,
  "keepWaitingPipelines": true,
  "limitConcurrent": false,
  "locked": {
    "allowUnlockUi": true,
    "description": "This pipeline is maintained by spinnaker as a code, any changes made through the ui will be overwritten",
    "ui": true
  },
  "parameterConfig": [
    {
      "default": "",
      "description": "Name of the test environment as registered in RPT.",
      "hasOptions": false,
      "label": "",
      "name": "TEST_ENVIRONMENT",
      "pinned": true,
      "required": true
    },
    {
      "default": "CXF1010181_1-R1A",
      "description": "Please append the R-state to the default value in the field. For Testing purpose please use, the R-state is already appended to the parameter (R1A).",
      "hasOptions": false,
      "label": "",
      "name": "ERIC_OSS_ADC_PRODUCT_NO",
      "pinned": true,
      "required": true
    },
    {
      "default": "CXF1010182_1-R1A",
      "description": "Please append the R-state to the default value in the field. For Testing purpose please use, the R-state is already appended to the parameter (R1A).",
      "hasOptions": false,
      "label": "",
      "name": "ERIC_OSS_ERICSSON_ADAPTATION_PRODUCT_NO",
      "pinned": true,
      "required": true
    },
    {
      "default": "CXF1010183_1-R1A",
      "description": "Please append the R-state to the default value in the field. For Testing purpose please use, the R-state is already appended to the parameter (R1A).",
      "hasOptions": false,
      "label": "",
      "name": "ERIC_OSS_APP_MGR_PRODUCT_NO",
      "pinned": true,
      "required": true
    },
    {
      "default": "CXF1010184_1-R1A",
      "description": "Please append the R-state to the default value in the field. For Testing purpose please use, the R-state is already appended to the parameter (R1A).",
      "hasOptions": false,
      "label": "",
      "name": "ERIC_OSS_CONFIG_HANDLING_PRODUCT_NO",
      "pinned": true,
      "required": true
    },
    {
      "default": "CXF1010185_1-R1A",
      "description": "Please append the R-state to the default value in the field. For Testing purpose please use, the R-state is already appended to the parameter (R1A).",
      "hasOptions": false,
      "label": "",
      "name": "ERIC_TOPOLOGY_HANDLING_PRODUCT_NO",
      "pinned": true,
      "required": true
    },
    {
      "default": "CXF1010186_1-R1A",
      "description": "Please append the R-state to the default value in the field. For Testing purpose please use, the R-state is already appended to the parameter (R1A).",
      "hasOptions": false,
      "label": "",
      "name": "ERIC_CLOUD_NATIVE_BASE_PRODUCT_NO",
      "pinned": true,
      "required": true
    },
    {
      "default": "CXF1010334_1-R1A",
      "description": "Please append the R-state to the default value in the field. For Testing purpose please use, the R-state is already appended to the parameter (R1A).",
      "hasOptions": false,
      "label": "",
      "name": "ERIC_CNBASE_OSS_CONFIG_PRODUCT_NO",
      "pinned": true,
      "required": true
    },
    {
      "default": "CXF1010333_1-R1A",
      "description": "Please append the R-state to the default value in the field. For Testing purpose please use, the R-state is already appended to the parameter (R1A).",
      "hasOptions": false,
      "label": "",
      "name": "ERIC_CNCS_OSS_CONFIG_PRODUCT_NO",
      "pinned": true,
      "required": true
    },
    {
      "default": "CXF1010187_1-R1A",
      "description": "Please append the R-state to the default value in the field. For Testing purpose please use, the R-state is already appended to the parameter (R1A).",
      "hasOptions": false,
      "label": "",
      "name": "ERIC_OSS_DMM_PRODUCT_NO",
      "pinned": true,
      "required": true
    },
    {
      "default": "CXF1010188_1-R1A",
      "description": "Please append the R-state to the default value in the field. For Testing purpose please use, the R-state is already appended to the parameter (R1A).",
      "hasOptions": false,
      "label": "",
      "name": "ERIC_OSS_COMMON_BASE_PRODUCT_NO",
      "pinned": true,
      "required": true
    },
    {
      "default": "CXF1010246_1-R1A",
      "description": "Please append the R-state to the default value in the field. For Testing purpose please use, the R-state is already appended to the parameter (R1A).",
      "hasOptions": false,
      "label": "",
      "name": "ERIC_CLOUD_NATIVE_SERVICE_MESH_PRODUCT_NO",
      "pinned": true,
      "required": true
    },
    {
      "default": "CXF1010192-R1A",
      "description": "Please append the R-state to the default value in the field. For Testing purpose please use, the R-state is already appended to the parameter (R1A).",
      "hasOptions": false,
      "label": "",
      "name": "EIAE_DEPLOYMENT_HELM_RELEASE_PACKAGE_PRODUCT_NO",
      "pinned": true,
      "required": true
    },
    {
      "default": "CXF1010193-R1A",
      "description": "Please append the R-state to the default value in the field. For Testing purpose please use, the R-state is already appended to the parameter (R1A).",
      "hasOptions": false,
      "label": "",
      "name": "OSS_DEPLOYMENT_MANAGER_RELEASE_PACKAGE_PRODUCT_NO",
      "pinned": true,
      "required": true
    },
    {
      "default": "CXF1010222_1-R1A",
      "description": "Please append the R-state to the default value in the field. For Testing purpose please use, the R-state is already appended to the parameter (R1A).",
      "hasOptions": false,
      "label": "",
      "name": "ERIC_OSS_ORAN_SUPPORT_PRODUCT_NO",
      "pinned": true,
      "required": true
    },
    {
      "default": "CXF1010224_1-R1A",
      "description": "Please append the R-state to the default value in the field. For Testing purpose please use, the R-state is already appended to the parameter (R1A).",
      "hasOptions": false,
      "label": "",
      "name": "ERIC_OSS_TASK_AUTOMATION_AE_PRODUCT_NO",
      "pinned": true,
      "required": true
    },
    {
      "default": "",
      "description": "The version of Deployment Manager to use.",
      "hasOptions": false,
      "label": "",
      "name": "OSS_DEPLOYMENT_MANAGER_VERSION",
      "pinned": true,
      "required": true
    },
    {
      "default": "",
      "description": "Namespace to install the Chart.",
      "hasOptions": false,
      "label": "",
      "name": "NAMESPACE",
      "pinned": true,
      "required": true
    },
    {
      "default": "",
      "description": "",
      "hasOptions": false,
      "label": "",
      "name": "SLAVE_LABEL",
      "pinned": true,
      "required": true
    },
    {
      "default": "/tmp",
      "description": "",
      "hasOptions": false,
      "label": "",
      "name": "DESTINATION_SERVER_PACKAGE_LOCATION",
      "pinned": true,
      "required": true
    },
    {
      "default": "",
      "description": "Namespace which was used to deploy the CRD.",
      "hasOptions": false,
      "label": "",
      "name": "CRD_NAMESPACE",
      "pinned": true,
      "required": true
    },
    {
      "default": "",
      "description": "Path on server where the working directory is available. E.g. /proj/cloudman. The working directory 'swgw_download_dir' will automatically be created.",
      "hasOptions": false,
      "label": "",
      "name": "CSAR_DOWNLOAD_LOCATION_PATH",
      "pinned": true,
      "required": true
    },
    {
      "default": "PARTIAL",
      "description": "The Type of cleanup that needs to be done. FULL will cleanup the deployment helm releases, crd helm releases, crd components, clusterroles, cluster rolebindings, namespaces (deployment and crd). Where as PARTIAL will only cleanup the deployment namespace. FULL cleanup option should NOT be used in such cases where single cluster is hosting multiple deployments.",
      "hasOptions": true,
      "label": "",
      "name": "CLEANUP_TYPE",
      "options": [
        {
          "value": "FULL"
        }
      ],
      "pinned": true,
      "required": true
    }
  ],
  "schema": "1",
  "spelEvaluator": "v4",
  "stages": [
    {
      "name": "Is environment name Azure_MANA",
      "preconditions": [
        {
          "context": {
            "expression": "parameters['TEST_ENVIRONMENT'] != 'Azure_MANA'",
            "failureMessage": "Please use an internal test environment only."
          },
          "failPipeline": true,
          "type": "expression"
        }
      ],
      "refId": "Is environment name Azure_MANA",
      "requisiteStageRefIds": [],
      "type": "checkPreconditions"
    },
    {
      "failPipeline": true,
      "instructions": "Are all pre-requisite done?",
      "judgmentInputs": [],
      "name": "Pre-requisites Verification",
      "notifications": [],
      "refId": "Pre-requisites Verification",
      "requisiteStageRefIds": ["Is environment name Azure_MANA"],
      "type": "manualJudgment"
    },
    {
      "continuePipeline": false,
      "failPipeline": true,
      "job": "oss-idun-release-cicd_Jenkins_Agent_Cleanup",
      "master": "oss-aispinn-fem5s11-eiffel052",
      "name": "Jenkins Agent Cleanup",
      "parameters": {
        "SLAVE": "${parameters['SLAVE_LABEL']}"
      },
      "refId": "Jenkins Agent Cleanup",
      "requisiteStageRefIds": ["Pre-requisites Verification"],
      "type": "jenkins"
    },
    {
      "continuePipeline": false,
      "failPipeline": true,
      "job": "DSC-DIT-Download-Document-As-Artifact",
      "master": "oss-fem5s11-eiffel216",
      "name": "Get Environment Details",
      "parameters": {
        "DIT_NAME_PARAMETER": "${parameters['TEST_ENVIRONMENT']}"
      },
      "propertyFile": "artifact.properties",
      "refId": "Get Environment Details",
      "requisiteStageRefIds": ["Jenkins Agent Cleanup"],
      "type": "jenkins"
    },
    {
      "continuePipeline": false,
      "failPipeline": true,
      "job": "Purge-Release-in-Namespace",
      "master": "oss-aispinn-fem5s11-eiffel052",
      "name": "Purge",
      "parameters": {
        "CLEANUP_TYPE": "${parameters['CLEANUP_TYPE']}",
        "ARMDOCKER_USER_SECRET": "reluser-creds-docker",
        "KUBECONFIG_FILE": "${#stage(\"Get Environment Details\")[\"context\"][\"KUBE_CONFIG_FILE_CREDENTIAL_ID\"]}",
        "NAMESPACE": "${#stage(\"Get Environment Details\")[\"context\"][\"NAMESPACE\"]}",
        "SLAVE_LABEL": "evo_docker_engine_athlone"
      },
      "refId": "Purge",
      "requisiteStageRefIds": ["Get Environment Details"],
      "type": "jenkins"
    },
    {
      "application": "common-e2e-cicd",
      "failPipeline": true,
      "name": "Pre-Deploy",
      "pipeline": "88012023-7839-4eca-92f4-f87715ed77ad",
      "pipelineParameters": {
        "ARMDOCKER_USER_SECRET": "reluser-creds-docker",
        "EXECUTE_AM_PREDEPLOYMENT_STEP": "yes",
        "KUBECONFIG_FILE": "${#stage(\"Get Environment Details\")[\"context\"][\"KUBE_CONFIG_FILE_CREDENTIAL_ID\"]}",
        "NAMESPACE": "${#stage(\"Get Environment Details\")[\"context\"][\"NAMESPACE\"]}",
        "SFTP_CREDENTIALS": "idun-bur-sftp-credentials"
      },
      "refId": "Pre-Deploy",
      "requisiteStageRefIds": ["Purge"],
      "type": "pipeline",
      "waitForCompletion": true
    },
    {
      "failPipeline": true,
      "instructions": "Please verify if package.tar.gz is available in the DESTINATION_SERVER_PACKAGE_LOCATION provided (default=/tmp).",
      "judgmentInputs": [],
      "name": "Transfer Package Verification",
      "notifications": [],
      "refId": "Transfer Package Verification",
      "requisiteStageRefIds": ["Pre-Deploy"],
      "type": "manualJudgment"
    },
    {
      "continuePipeline": false,
      "failPipeline": true,
      "job": "oss-idun-release-cicd_Unpack_And_Push_Images_Internal_Testing",
      "master": "oss-aispinn-fem5s11-eiffel052",
      "name": "Test Unpack and Push Images",
      "parameters": {
        "CSAR_DOWNLOAD_LOCATION_PATH": "${parameters['CSAR_DOWNLOAD_LOCATION_PATH']}",
        "DESTINATION_SERVER_PACKAGE_LOCATION": "${parameters['DESTINATION_SERVER_PACKAGE_LOCATION']}",
        "EIAE_DEPLOYMENT_HELM_RELEASE_PACKAGE_PRODUCT_NO": "${parameters['EIAE_DEPLOYMENT_HELM_RELEASE_PACKAGE_PRODUCT_NO']}",
        "ERIC_CLOUD_NATIVE_BASE_PRODUCT_NO": "${parameters['ERIC_CLOUD_NATIVE_BASE_PRODUCT_NO']}",
        "ERIC_CLOUD_NATIVE_SERVICE_MESH_PRODUCT_NO": "${parameters['ERIC_CLOUD_NATIVE_SERVICE_MESH_PRODUCT_NO']}",
        "ERIC_CNBASE_OSS_CONFIG_PRODUCT_NO": "${parameters['ERIC_CNBASE_OSS_CONFIG_PRODUCT_NO']}",
        "ERIC_CNCS_OSS_CONFIG_PRODUCT_NO": "${parameters['ERIC_CNCS_OSS_CONFIG_PRODUCT_NO']}",
        "ERIC_OSS_ADC_PRODUCT_NO": "${parameters['ERIC_OSS_ADC_PRODUCT_NO']}",
        "ERIC_OSS_APP_MGR_PRODUCT_NO": "${parameters['ERIC_OSS_APP_MGR_PRODUCT_NO']}",
        "ERIC_OSS_COMMON_BASE_PRODUCT_NO": "${parameters['ERIC_OSS_COMMON_BASE_PRODUCT_NO']}",
        "ERIC_OSS_CONFIG_HANDLING_PRODUCT_NO": "${parameters['ERIC_OSS_CONFIG_HANDLING_PRODUCT_NO']}",
        "ERIC_OSS_DMM_PRODUCT_NO": "${parameters['ERIC_OSS_DMM_PRODUCT_NO']}",
        "ERIC_OSS_ERICSSON_ADAPTATION_PRODUCT_NO": "${parameters['ERIC_OSS_ERICSSON_ADAPTATION_PRODUCT_NO']}",
        "ERIC_OSS_ORAN_SUPPORT_PRODUCT_NO": "${parameters['ERIC_OSS_ORAN_SUPPORT_PRODUCT_NO']}",
        "ERIC_OSS_TASK_AUTOMATION_AE_PRODUCT_NO": "${parameters['ERIC_OSS_TASK_AUTOMATION_AE_PRODUCT_NO']}",
        "ERIC_TOPOLOGY_HANDLING_PRODUCT_NO": "${parameters['ERIC_TOPOLOGY_HANDLING_PRODUCT_NO']}",
        "KUBECONFIG_FILE": "${#stage(\"Get Environment Details\")[\"context\"][\"KUBE_CONFIG_FILE_CREDENTIAL_ID\"]}",
        "NAMESPACE": "${parameters['NAMESPACE']}",
        "OSS_DEPLOYMENT_MANAGER_RELEASE_PACKAGE_PRODUCT_NO": "${parameters['OSS_DEPLOYMENT_MANAGER_RELEASE_PACKAGE_PRODUCT_NO']}",
        "OSS_DEPLOYMENT_MANAGER_VERSION": "${parameters['OSS_DEPLOYMENT_MANAGER_VERSION']}",
        "SLAVE_LABEL": "${parameters['SLAVE_LABEL']}"
      },
      "refId": "Test Unpack and Push Images",
      "requisiteStageRefIds": ["Transfer Package Verification"],
      "type": "jenkins"
    },
    {
      "failPipeline": true,
      "instructions": "Please verify if all the images are present in the ACR. If yes, please press continue.",
      "judgmentInputs": [],
      "name": "Checkpoint",
      "notifications": [],
      "refId": "Checkpoint",
      "requisiteStageRefIds": ["Test Unpack and Push Images"],
      "type": "manualJudgment"
    },
    {
      "continuePipeline": false,
      "failPipeline": true,
      "job": "oss-idun-release-cicd_MANA_Deploy_Internal_Testing",
      "master": "oss-aispinn-fem5s11-eiffel052",
      "name": "Test MANA Deploy",
      "parameters": {
        "CRD_NAMESPACE": "${parameters['CRD_NAMESPACE']}",
        "CSAR_DOWNLOAD_LOCATION_PATH": "${parameters['CSAR_DOWNLOAD_LOCATION_PATH']}",
        "DEPLOYMENT_TYPE": "install",
        "DESTINATION_SERVER_PACKAGE_LOCATION": "${parameters['DESTINATION_SERVER_PACKAGE_LOCATION']}",
        "EIAE_DEPLOYMENT_HELM_RELEASE_PACKAGE_PRODUCT_NO": "${parameters['EIAE_DEPLOYMENT_HELM_RELEASE_PACKAGE_PRODUCT_NO']}",
        "ERIC_CLOUD_NATIVE_BASE_PRODUCT_NO": "${parameters['ERIC_CLOUD_NATIVE_BASE_PRODUCT_NO']}",
        "ERIC_CLOUD_NATIVE_SERVICE_MESH_PRODUCT_NO": "${parameters['ERIC_CLOUD_NATIVE_SERVICE_MESH_PRODUCT_NO']}",
        "ERIC_CNBASE_OSS_CONFIG_PRODUCT_NO": "${parameters['ERIC_CNBASE_OSS_CONFIG_PRODUCT_NO']}",
        "ERIC_CNCS_OSS_CONFIG_PRODUCT_NO": "${parameters['ERIC_CNCS_OSS_CONFIG_PRODUCT_NO']}",
        "ERIC_OSS_ADC_PRODUCT_NO": "${parameters['ERIC_OSS_ADC_PRODUCT_NO']}",
        "ERIC_OSS_APP_MGR_PRODUCT_NO": "${parameters['ERIC_OSS_APP_MGR_PRODUCT_NO']}",
        "ERIC_OSS_COMMON_BASE_PRODUCT_NO": "${parameters['ERIC_OSS_COMMON_BASE_PRODUCT_NO']}",
        "ERIC_OSS_CONFIG_HANDLING_PRODUCT_NO": "${parameters['ERIC_OSS_CONFIG_HANDLING_PRODUCT_NO']}",
        "ERIC_OSS_DMM_PRODUCT_NO": "${parameters['ERIC_OSS_DMM_PRODUCT_NO']}",
        "ERIC_OSS_ERICSSON_ADAPTATION_PRODUCT_NO": "${parameters['ERIC_OSS_ERICSSON_ADAPTATION_PRODUCT_NO']}",
        "ERIC_OSS_ORAN_SUPPORT_PRODUCT_NO": "${parameters['ERIC_OSS_ORAN_SUPPORT_PRODUCT_NO']}",
        "ERIC_OSS_TASK_AUTOMATION_AE_PRODUCT_NO": "${parameters['ERIC_OSS_TASK_AUTOMATION_AE_PRODUCT_NO']}",
        "ERIC_TOPOLOGY_HANDLING_PRODUCT_NO": "${parameters['ERIC_TOPOLOGY_HANDLING_PRODUCT_NO']}",
        "KUBECONFIG_FILE": "${#stage(\"Get Environment Details\")[\"context\"][\"KUBE_CONFIG_FILE_CREDENTIAL_ID\"]}",
        "NAMESPACE": "${parameters['NAMESPACE']}",
        "OSS_DEPLOYMENT_MANAGER_RELEASE_PACKAGE_PRODUCT_NO": "${parameters['OSS_DEPLOYMENT_MANAGER_RELEASE_PACKAGE_PRODUCT_NO']}",
        "OSS_DEPLOYMENT_MANAGER_VERSION": "${parameters['OSS_DEPLOYMENT_MANAGER_VERSION']}",
        "SLAVE_LABEL": "${parameters['SLAVE_LABEL']}"
      },
      "refId": "Test MANA Deploy",
      "requisiteStageRefIds": ["Checkpoint"],
      "type": "jenkins"
    },
    {
      "completeOtherBranchesThenFail": false,
      "continuePipeline": true,
      "failPipeline": false,
      "job": "oss-idun-release-cicd_MANA_Health_Check_Internal_Testing",
      "markUnstableAsSuccessful": true,
      "master": "oss-aispinn-fem5s11-eiffel052",
      "name": "Post Deploy Health Check",
      "parameters": {
        "CSAR_DOWNLOAD_LOCATION_PATH": "${parameters['CSAR_DOWNLOAD_LOCATION_PATH']}",
        "KUBECONFIG_FILE": "${#stage(\"Get Environment Details\")[\"context\"][\"KUBE_CONFIG_FILE_CREDENTIAL_ID\"]}",
        "NAMESPACE": "${parameters['NAMESPACE']}",
        "OSS_DEPLOYMENT_MANAGER_RELEASE_PACKAGE_PRODUCT_NO": "${parameters['OSS_DEPLOYMENT_MANAGER_RELEASE_PACKAGE_PRODUCT_NO']}",
        "OSS_DEPLOYMENT_MANAGER_VERSION": "${parameters['OSS_DEPLOYMENT_MANAGER_VERSION']}",
        "SLAVE_LABEL": "${parameters['SLAVE_LABEL']}"
      },
      "refId": "Post Deploy Health Check",
      "requisiteStageRefIds": ["Test MANA Deploy"],
      "stageEnabled": {
        "expression": "#stage('Test MANA Deploy')['status'] == \"SUCCEEDED\"",
        "type": "expression"
      },
      "type": "jenkins"
    }
  ],
  "triggers": []
}
